# 美港股监控系统使用指南

## 功能概述

本系统集成了美港股实时监控功能，支持：
- 🔍 实时监控美股和港股价格变动
- 📊 设置涨跌幅阈值告警
- 💬 企业微信自动推送告警消息
- 🌐 Web界面配置和管理
- ⏰ 每分钟自动检查（仅在市场开盘时间）

## 快速开始

### 1. 启动Web配置界面

```bash
python3 stock_web_config.py
```

访问地址：http://localhost:8080

### 2. 启动股票监控定时任务

```bash
python3 start_stock_monitor.py
```

## Web界面功能

### 股票管理
- **添加股票**：输入股票代码、名称、涨跌幅阈值
- **删除股票**：移除不需要监控的股票
- **更新阈值**：修改告警阈值
- **手动监控**：立即执行一次监控检查

### 系统设置
- **检查间隔**：设置监控频率（默认60秒）
- **企微配置**：配置企业微信推送参数

## 股票代码格式

### 美股
- 苹果：`AAPL`
- 特斯拉：`TSLA`
- 微软：`MSFT`
- 谷歌：`GOOGL`

### 港股
- 腾讯控股：`0700.HK`
- 中国移动：`0941.HK`
- 阿里巴巴：`9988.HK`
- 美团：`3690.HK`

## 配置文件

### stock_config.json
```json
{
  "stocks": {
    "AAPL": {
      "name": "苹果公司",
      "threshold_up": 3.0,
      "threshold_down": -3.0,
      "market": "US"
    }
  },
  "settings": {
    "check_interval": 60,
    "market_hours": {
      "US": {"start": "09:30", "end": "16:00", "timezone": "US/Eastern"},
      "HK": {"start": "09:30", "end": "16:00", "timezone": "Asia/Hong_Kong"}
    }
  }
}
```

## 告警消息格式

当股票涨跌幅达到设定阈值时，系统会发送企业微信消息：

```
📈 股票告警提醒

股票：苹果公司 (AAPL)
当前价格：$150.25
涨跌幅：+3.5%
触发阈值：+3.0%

时间：2025-01-06 14:30:00
```

## 市场开盘时间

- **美股**：周一至周五 09:30-16:00 (EST)
- **港股**：周一至周五 09:30-16:00 (HKT)

## 日志文件

- 监控日志：`logs/stock_monitor.log`
- Web服务日志：控制台输出

## 注意事项

1. **数据源限制**：使用Yahoo Finance API，可能存在频率限制
2. **网络依赖**：需要稳定的网络连接获取股票数据
3. **市场时间**：仅在相应市场开盘时间进行监控
4. **企微配置**：确保企业微信配置正确，否则无法发送告警

## 故障排除

### 无法获取股票数据
- 检查网络连接
- 确认股票代码格式正确
- 等待一段时间后重试（可能是API限制）

### 企微消息发送失败
- 检查 `config/config.yaml` 中的企微配置
- 确认webhook地址有效
- 检查网络连接

### Web界面无法访问
- 确认端口8080未被占用
- 检查防火墙设置
- 查看控制台错误信息

## 技术架构

- **数据获取**：yfinance (Yahoo Finance API)
- **Web框架**：Flask
- **定时任务**：schedule
- **数据处理**：pandas
- **配置管理**：JSON文件
- **日志记录**：Python logging

---

如有问题，请查看日志文件或联系技术支持。